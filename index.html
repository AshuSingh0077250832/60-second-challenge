 body {
        font-family: 'Poppins', sans-serif;
        background: linear-gradient(135deg, #6366f1, #8b5cf6);
        min-height: 100vh;
        overflow-x: hidden;
    }
    
    .game-container {
        max-width: 500px;
        margin: 0 auto;
        position: relative;
    }
    
    .progress-bar {
        height: 10px;
        background-color: rgba(255, 255, 255, 0.3);
        border-radius: 5px;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .progress-fill {
        height: 100%;
        background-color: #4ade80;
        transition: width 0.5s ease-out;
    }
    
    .option {
        cursor: pointer;
        transition: all 0.2s ease;
        border: 2px solid transparent;
    }
    
    .option:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        border-color: rgba(255, 255, 255, 0.5);
    }
    
    .option.selected {
        border-color: #4ade80;
        background-color: rgba(74, 222, 128, 0.1);
    }
    
    .option.incorrect {
        border-color: #f87171;
        background-color: rgba(248, 113, 113, 0.1);
    }
    
    .badge {
        position: absolute;
        top: -10px;
        right: -10px;
        background: #fbbf24;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        opacity: 0;
        transform: scale(0);
        transition: all 0.3s ease;
    }
    
    .badge.show {
        opacity: 1;
        transform: scale(1);
    }
    
    .points-popup {
        position: absolute;
        color: #4ade80;
        font-weight: bold;
        font-size: 1.2rem;
        pointer-events: none;
        opacity: 0;
        animation: float-up 1s ease-out forwards;
    }
    
    @keyframes float-up {
        0% {
            opacity: 0;
            transform: translateY(0);
        }
        20% {
            opacity: 1;
        }
        100% {
            opacity: 0;
            transform: translateY(-50px);
        }
    }
    
    .confetti {
        position: absolute;
        width: 10px;
        height: 10px;
        opacity: 0;
    }
    
    @keyframes fall {
        0% {
            opacity: 1;
            top: -10px;
            transform: translateX(0) rotate(0deg);
        }
        100% {
            opacity: 0;
            top: 100vh;
            transform: translateX(100px) rotate(360deg);
        }
    }
    
    .starburst {
        position: absolute;
        width: 0;
        height: 0;
        border-radius: 50%;
        background-color: rgba(255, 255, 255, 0.8);
        transform: translate(-50%, -50%);
        pointer-events: none;
        z-index: 10;
        animation: starburst 0.5s ease-out forwards;
    }
    
    @keyframes starburst {
        0% {
            width: 0;
            height: 0;
            opacity: 1;
        }
        100% {
            width: 300px;
            height: 300px;
            opacity: 0;
        }
    }
    
    .timer {
        width: 100%;
        height: 4px;
        background-color: rgba(255, 255, 255, 0.3);
        position: relative;
        overflow: hidden;
    }
    
    .timer-bar {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        background-color: #fbbf24;
        transition: width linear;
    }
    
    .fade-in {
        animation: fadeIn 0.5s ease forwards;
        opacity: 0;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    .slide-in {
        animation: slideIn 0.5s ease forwards;
        transform: translateY(20px);
        opacity: 0;
    }
    
    @keyframes slideIn {
        from { 
            transform: translateY(20px);
            opacity: 0;
        }
        to { 
            transform: translateY(0);
            opacity: 1;
        }
    }
    
    .pulse {
        animation: pulse 1s infinite;
    }
    
    @keyframes pulse {
        0% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.05);
        }
        100% {
            transform: scale(1);
        }
    }
    
    .badge-earned {
        animation: badgeEarned 0.5s ease-out forwards;
        transform: scale(0);
    }
    
    @keyframes badgeEarned {
        0% {
            transform: scale(0) rotate(-15deg);
            opacity: 0;
        }
        50% {
            transform: scale(1.2) rotate(10deg);
            opacity: 1;
        }
        100% {
            transform: scale(1) rotate(0deg);
            opacity: 1;
        }
    }
    
    .theme-movies {
        background: linear-gradient(135deg, #f43f5e, #ec4899);
    }
    
    .theme-cricket {
        background: linear-gradient(135deg, #0ea5e9, #3b82f6);
    }
    
    .theme-emoji {
        background: linear-gradient(135deg, #f59e0b, #fbbf24);
    }
    
    .emoji-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
    }
    
    .emoji-item {
        font-size: 2rem;
        text-align: center;
    }
    
    .level-badge {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        position: relative;
    }
    
    .level-badge::after {
        content: '';
        position: absolute;
        top: -5px;
        right: -5px;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #4ade80;
        opacity: 0;
        transform: scale(0);
        transition: all 0.3s ease;
    }
    
    .level-badge.completed::after {
        opacity: 1;
        transform: scale(1);
    }
    
    .level-badge.completed::before {
        content: '‚úì';
        position: absolute;
        top: -5px;
        right: -5px;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 12px;
        font-weight: bold;
        z-index: 1;
    }
    
    .level-connector {
        height: 2px;
        background-color: #d1d5db;
        flex-grow: 1;
        position: relative;
    }
    
    .level-connector.active {
        background-color: #4ade80;
    }
    
    .level-badge.active {
        transform: scale(1.1);
        box-shadow: 0 0 0 4px rgba(74, 222, 128, 0.3);
    }
    
    .level-badge.locked {
        filter: grayscale(1);
        opacity: 0.7;
    }
    
    .level-name {
        position: absolute;
        bottom: -25px;
        left: 50%;
        transform: translateX(-50%);
        white-space: nowrap;
        font-size: 0.75rem;
        font-weight: 500;
    }
    
    .difficulty-badge {
        position: absolute;
        top: -20px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 0.65rem;
        padding: 2px 6px;
        border-radius: 10px;
        white-space: nowrap;
    }
</style>

        <div class="flex items-center justify-center mb-8 px-4 relative">
            <div class="level-badge theme-movies flex-shrink-0 active" data-level="movies">
                <span>üé¨</span>
                <span class="level-name">Movies</span>
                <span class="difficulty-badge bg-green-100 text-green-800">Easy</span>
            </div>
            
            <div class="level-connector"></div>
            
            <div class="level-badge theme-cricket flex-shrink-0 locked" data-level="cricket">
                <span>üèè</span>
                <span class="level-name">Cricket</span>
                <span class="difficulty-badge bg-yellow-100 text-yellow-800">Medium</span>
            </div>
            
            <div class="level-connector"></div>
            
            <div class="level-badge theme-emoji flex-shrink-0 locked" data-level="emoji">
                <span>üòé</span>
                <span class="level-name">Emoji</span>
                <span class="difficulty-badge bg-red-100 text-red-800">Hard</span>
            </div>
        </div>
        
        <button id="start-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-3 px-8 rounded-lg transition-all pulse">
            Start Challenge
        </button>
        
        <div class="mt-4 text-sm text-gray-500">
            <p>Complete all 3 levels in under 60 seconds!</p>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="game-screen" class="hidden">
        <!-- Header -->
        <div id="game-header" class="bg-white rounded-t-xl p-4 shadow-lg theme-movies">
            <div class="flex justify-between items-center mb-2">
                <div class="flex items-center">
                    <span id="game-title" class="text-lg font-bold text-white">Level 1: Movies</span>
                    <div class="ml-2 bg-white text-indigo-800 px-2 py-0.5 rounded-full text-xs">
                        Question <span id="current-question">1</span>/3
                    </div>
                </div>
                <div class="flex items-center">
                    <span class="text-yellow-300 mr-1">‚≠ê</span>
                    <span id="points" class="font-bold text-white">0</span>
                </div>
            </div>
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
            </div>
        </div>
        
        <!-- Timer -->
        <div class="timer">
            <div id="timer-bar" class="timer-bar"></div>
        </div>
        
        <!-- Content -->
        <div class="bg-white p-6 shadow-lg">
            <div id="question-container" class="mb-4">
                <h2 id="question-text" class="text-lg font-bold text-gray-800 mb-3"></h2>
            </div>
            
            <div id="options-container" class="grid grid-cols-1 gap-3 mb-4">
                <!-- Options will be inserted here -->
            </div>
            
            <div class="mt-4 flex justify-end">
                <button id="next-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-6 rounded-lg transition-all opacity-50" disabled>
                    Next
                </button>
            </div>
        </div>
    </div>
    
    <!-- Level Complete Screen -->
    <div id="level-complete-screen" class="hidden bg-white rounded-xl p-6 shadow-lg text-center">
        <div class="relative">
            <h1 class="text-2xl font-bold text-indigo-600 mb-2">Level Complete!</h1>
            <div id="level-complete-icon" class="text-5xl mb-4">üé¨</div>
            <p class="text-lg mb-2">You scored <span id="level-score" class="font-bold text-indigo-600">0</span> points!</p>
            <p id="level-message" class="text-gray-600 mb-6">Great job! You've completed the Movies level.</p>
            
            <button id="next-level-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-6 rounded-lg transition-all">
                Next Level
            </button>
        </div>
    </div>
    
    <!-- Results Screen -->
    <div id="results-screen" class="hidden bg-white rounded-xl p-6 shadow-lg text-center">
        <div class="relative">
            <h1 class="text-2xl font-bold text-indigo-600 mb-2">üéâ Well played!</h1>
            <p class="text-lg mb-2">You scored <span id="final-score" class="font-bold text-indigo-600">0</span> points in just <span id="time-taken" class="font-bold text-indigo-600">0</span> seconds.</p>
            
            <div class="bg-gray-50 rounded-lg p-4 mb-6">
                <p class="font-medium text-gray-800 mb-2">That was gamification in action ‚Äì you just experienced:</p>
                <ul class="text-left space-y-2 mb-4">
                    <li class="flex items-center">
                        <span class="text-green-500 mr-2">‚úÖ</span>
                        <span>Progress tracking (Points & Levels)</span>
                    </li>
                    <li class="flex items-center">
                        <span class="text-green-500 mr-2">‚úÖ</span>
                        <span>Feedback (Instant reactions)</span>
                    </li>
                    <li class="flex items-center">
                        <span class="text-green-500 mr-2">‚úÖ</span>
                        <span>Challenge (Timer pressure & Increasing difficulty)</span>
                    </li>
                    <li class="flex items-center">
                        <span class="text-green-500 mr-2">‚úÖ</span>
                        <span>Rewards (Badges & Unlocks)</span>
                    </li>
                </ul>
                
                <p class="text-sm text-gray-600 mb-3">Other powerful gamification elements include:</p>
                <div class="grid grid-cols-2 gap-2 text-xs mb-4">
                    <div class="bg-indigo-50 p-2 rounded">
                        <span class="font-medium text-indigo-600">üîÑ Storyline</span>
                        <p class="text-gray-600">Narrative that engages users</p>
                    </div>
                    <div class="bg-indigo-50 p-2 rounded">
                        <span class="font-medium text-indigo-600">ü§ù Social</span>
                        <p class="text-gray-600">Competition & collaboration</p>
                    </div>
                    <div class="bg-indigo-50 p-2 rounded">
                        <span class="font-medium text-indigo-600">üìä Leaderboards</span>
                        <p class="text-gray-600">Ranking & status</p>
                    </div>
                    <div class="bg-indigo-50 p-2 rounded">
                        <span class="font-medium text-indigo-600">üéØ Goals</span>
                        <p class="text-gray-600">Clear objectives & milestones</p>
                    </div>
                </div>
                
                <div class="flex justify-center space-x-2 mb-2">
                    <div id="earned-badge" class="w-16 h-16 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-2xl shadow-md">üèÜ</div>
                </div>
                
                <div id="badge-title" class="text-sm font-medium text-indigo-600">Gamification Master</div>
            </div>
            
            <p class="text-lg font-medium text-gray-700 mb-4">Cool, right?</p>
            
            <a href="#" id="cta-btn" class="inline-block bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-6 rounded-lg transition-all">
                Learn more about gamification principles
            </a>
            
            <button id="play-again-btn" class="mt-3 inline-block bg-white border border-indigo-600 text-indigo-600 hover:bg-indigo-50 font-medium py-2 px-6 rounded-lg transition-all">
                Play Again
            </button>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Game data
        const gameData = {
            movies: {
                title: "Level 1: Movies",
                icon: "üé¨",
                badge: "üé¨",
                badgeTitle: "Movie Buff",
                themeClass: "theme-movies",
                difficulty: "Easy",
                timerDuration: 15,
                questions: [
                    {
                        text: "Which movie features a character named Jack Dawson?",
                        options: [
                            { text: "Titanic", correct: true, points: 10 },
                            { text: "Avatar", correct: false, points: 0 },
                            { text: "The Revenant", correct: false, points: 0 },
                            { text: "Inception", correct: false, points: 0 }
                        ]
                    },
                    {
                        text: "Who directed the movie 'Jurassic Park'?",
                        options: [
                            { text: "James Cameron", correct: false, points: 0 },
                            { text: "Steven Spielberg", correct: true, points: 10 },
                            { text: "Christopher Nolan", correct: false, points: 0 },
                            { text: "George Lucas", correct: false, points: 0 }
                        ]
                    },
                    {
                        text: "Which of these is NOT a Marvel superhero movie?",
                        options: [
                            { text: "Black Panther", correct: false, points: 0 },
                            { text: "Captain America", correct: false, points: 0 },
                            { text: "The Dark Knight", correct: true, points: 10 },
                            { text: "Thor", correct: false, points: 0 }
                        ]
                    }
                ]
            },
            cricket: {
                title: "Level 2: Cricket",
                icon: "üèè",
                badge: "üèè",
                badgeTitle: "Cricket Champ",
                themeClass: "theme-cricket",
                difficulty: "Medium",
                timerDuration: 12,
                questions: [
                    {
                        text: "Which cricketer is known as 'The Little Master'?",
                        options: [
                            { text: "Virat Kohli", correct: false, points: 0 },
                            { text: "Sachin Tendulkar", correct: true, points: 15 },
                            { text: "MS Dhoni", correct: false, points: 0 },
                            { text: "Ricky Ponting", correct: false, points: 0 }
                        ]
                    },
                    {
                        text: "In cricket, what is a 'googly'?",
                        options: [
                            { text: "A type of bat", correct: false, points: 0 },
                            { text: "A fielding position", correct: false, points: 0 },
                            { text: "A deceptive bowling delivery", correct: true, points: 15 },
                            { text: "A scoring shot", correct: false, points: 0 }
                        ]
                    },
                    {
                        text: "Which country has won the most Cricket World Cups?",
                        options: [
                            { text: "India", correct: false, points: 0 },
                            { text: "West Indies", correct: false, points: 0 },
                            { text: "England", correct: false, points: 0 },
                            { text: "Australia", correct: true, points: 15 }
                        ]
                    }
                ]
            },
            emoji: {
                title: "Level 3: Emoji Quiz",
                icon: "üòé",
                badge: "üß©",
                badgeTitle: "Emoji Master",
                themeClass: "theme-emoji",
                difficulty: "Hard",
                timerDuration: 10,
                questions: [
                    {
                        text: "Guess the movie: üëª üë®‚Äçüë©‚Äçüëß üëª",
                        options: [
                            { text: "Ghost", correct: false, points: 0 },
                            { text: "The Sixth Sense", correct: false, points: 0 },
                            { text: "Poltergeist", correct: true, points: 20 },
                            { text: "Casper", correct: false, points: 0 }
                        ]
                    },
                    {
                        text: "Guess the cricketer: üèè üëë üáÆüá≥",
                        options: [
                            { text: "Virat Kohli", correct: true, points: 20 },
                            { text: "Rohit Sharma", correct: false, points: 0 },
                            { text: "MS Dhoni", correct: false, points: 0 },
                            { text: "Sachin Tendulkar", correct: false, points: 0 }
                        ]
                    },
                    {
                        text: "Guess the movie: üö¢ üíé üíè ‚ùÑÔ∏è",
                        options: [
                            { text: "The Perfect Storm", correct: false, points: 0 },
                            { text: "Titanic", correct: true, points: 20 },
                            { text: "Pirates of the Caribbean", correct: false, points: 0 },
                            { text: "Frozen", correct: false, points: 0 }
                        ]
                    }
                ]
            }
        };
        
        // Game state
        const gameState = {
            currentLevel: "movies",
            levels: ["movies", "cricket", "emoji"],
            currentLevelIndex: 0,
            currentQuestion: 1,
            totalQuestions: 3,
            points: 0,
            levelPoints: {},
            questionAnswered: false,
            timerDuration: 15, // seconds
            timerInterval: null,
            startTime: null,
            endTime: null,
            completedLevels: []
        };
        
        // DOM Elements
        const welcomeScreen = document.getElementById('welcome-screen');
        const gameScreen = document.getElementById('game-screen');
        const levelCompleteScreen = document.getElementById('level-complete-screen');
        const resultsScreen = document.getElementById('results-screen');
        const startBtn = document.getElementById('start-btn');
        const nextBtn = document.getElementById('next-btn');
        const nextLevelBtn = document.getElementById('next-level-btn');
        const gameTitle = document.getElementById('game-title');
        const gameHeader = document.getElementById('game-header');
        const currentQuestionEl = document.getElementById('current-question');
        const pointsEl = document.getElementById('points');
        const progressFill = document.getElementById('progress-fill');
        const timerBar = document.getElementById('timer-bar');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const levelCompleteIcon = document.getElementById('level-complete-icon');
        const levelScore = document.getElementById('level-score');
        const levelMessage = document.getElementById('level-message');
        const finalScoreEl = document.getElementById('final-score');
        const timeTakenEl = document.getElementById('time-taken');
        const earnedBadgeEl = document.getElementById('earned-badge');
        const badgeTitleEl = document.getElementById('badge-title');
        const playAgainBtn = document.getElementById('play-again-btn');
        
        // Event Listeners
        startBtn.addEventListener('click', startGame);
        nextBtn.addEventListener('click', nextQuestion);
        nextLevelBtn.addEventListener('click', startNextLevel);
        playAgainBtn.addEventListener('click', resetGame);
        
        function startGame() {
            // Reset game state
            gameState.currentLevelIndex = 0;
            gameState.currentLevel = gameState.levels[gameState.currentLevelIndex];
            gameState.currentQuestion = 1;
            gameState.points = 0;
            gameState.levelPoints = {};
            gameState.questionAnswered = false;
            gameState.startTime = Date.now();
            gameState.completedLevels = [];
            
            // Initialize level points
            gameState.levels.forEach(level => {
                gameState.levelPoints[level] = 0;
            });
            
            // Update UI
            welcomeScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            
            // Set theme styling
            updateLevelTheme();
            
            // Load first question
            loadQuestion();
            
            // Start timer
            startTimer();
        }
        
        function updateLevelTheme() {
            const levelData = gameData[gameState.currentLevel];
            
            // Update header theme
            gameHeader.className = "bg-white rounded-t-xl p-4 shadow-lg " + levelData.themeClass;
            
            // Update game title
            gameTitle.textContent = levelData.title;
            
            // Update timer duration
            gameState.timerDuration = levelData.timerDuration;
        }
        
        function loadQuestion() {
            // Get current question data
            const questionData = gameData[gameState.currentLevel].questions[gameState.currentQuestion - 1];
            
            // Update question text
            questionText.textContent = questionData.text;
            
            // Clear options container
            optionsContainer.innerHTML = '';
            
            // Add options
            questionData.options.forEach((option, index) => {
                const optionEl = document.createElement('div');
                optionEl.className = 'option relative bg-gray-50 p-4 rounded-lg';
                optionEl.setAttribute('data-index', index);
                optionEl.setAttribute('data-correct', option.correct);
                optionEl.setAttribute('data-points', option.points);
                
                optionEl.innerHTML = `
                    <p class="text-gray-700">${option.text}</p>
                    <div class="badge">+${option.points}</div>
                `;
                
                optionEl.addEventListener('click', handleOptionClick);
                optionsContainer.appendChild(optionEl);
            });
            
            // Update progress
            currentQuestionEl.textContent = gameState.currentQuestion;
            updateProgress();
            
            // Reset state
            gameState.questionAnswered = false;
            nextBtn.disabled = true;
            nextBtn.classList.add('opacity-50');
        }
        
        function handleOptionClick(e) {
            if (gameState.questionAnswered) return;
            
            const option = e.currentTarget;
            const isCorrect = option.getAttribute('data-correct') === 'true';
            const points = parseInt(option.getAttribute('data-points'));
            
            // Mark all options
            document.querySelectorAll('.option').forEach(opt => {
                const optCorrect = opt.getAttribute('data-correct') === 'true';
                if (opt === option) {
                    opt.classList.add(isCorrect ? 'selected' : 'incorrect');
                } else if (optCorrect) {
                    opt.classList.add('selected');
                }
            });
            
            // Award points if correct
            if (isCorrect) {
                // Update points
                gameState.points += points;
                gameState.levelPoints[gameState.currentLevel] += points;
                pointsEl.textContent = gameState.points;
                
                // Show points badge
                const badge = option.querySelector('.badge');
                badge.classList.add('show');
                
                // Show points popup
                const rect = option.getBoundingClientRect();
                const popup = document.createElement('div');
                popup.className = 'points-popup';
                popup.textContent = `+${points}`;
                popup.style.left = `${rect.left + rect.width / 2}px`;
                popup.style.top = `${rect.top + rect.height / 2}px`;
                document.body.appendChild(popup);
                
                // Remove popup after animation
                setTimeout(() => {
                    document.body.removeChild(popup);
                }, 1000);
                
                // Create starburst effect
                createStarburst(rect.left + rect.width / 2, rect.top + rect.height / 2);
            }
            
            // Mark question as answered
            gameState.questionAnswered = true;
            
            // Enable next button
            nextBtn.disabled = false;
            nextBtn.classList.remove('opacity-50');
            
            // Clear timer
            clearInterval(gameState.timerInterval);
        }
        
        function nextQuestion() {
            if (gameState.currentQuestion < gameState.totalQuestions) {
                // Increment question
                gameState.currentQuestion++;
                
                // Load next question
                loadQuestion();
                
                // Restart timer
                startTimer();
            } else {
                // Level completed
                completedLevel();
            }
        }
        
        function completedLevel() {
            // Add to completed levels
            gameState.completedLevels.push(gameState.currentLevel);
            
            // Hide game screen
            gameScreen.classList.add('hidden');
            
            // Update level complete screen
            const levelData = gameData[gameState.currentLevel];
            levelCompleteIcon.textContent = levelData.icon;
            levelScore.textContent = gameState.levelPoints[gameState.currentLevel];
            
            // Set level message
            if (gameState.currentLevelIndex < gameState.levels.length - 1) {
                const nextLevel = gameState.levels[gameState.currentLevelIndex + 1];
                const nextLevelData = gameData[nextLevel];
                levelMessage.textContent = `Great job! You've unlocked the ${nextLevelData.difficulty} level: ${nextLevelData.title}`;
                nextLevelBtn.textContent = "Next Level";
            } else {
                levelMessage.textContent = "Amazing! You've completed all levels!";
                nextLevelBtn.textContent = "See Results";
            }
            
            // Show level complete screen
            levelCompleteScreen.classList.remove('hidden');
            
            // Update welcome screen badges
            updateLevelBadges();
        }
        
        function startNextLevel() {
            // Hide level complete screen
            levelCompleteScreen.classList.add('hidden');
            
            if (gameState.currentLevelIndex < gameState.levels.length - 1) {
                // Move to next level
                gameState.currentLevelIndex++;
                gameState.currentLevel = gameState.levels[gameState.currentLevelIndex];
                gameState.currentQuestion = 1;
                
                // Update UI
                updateLevelTheme();
                
                // Show game screen
                gameScreen.classList.remove('hidden');
                
                // Load first question
                loadQuestion();
                
                // Start timer
                startTimer();
            } else {
                // All levels completed
                gameState.endTime = Date.now();
                showResults();
            }
        }
        
        function updateProgress() {
            const progress = ((gameState.currentQuestion - 1) / gameState.totalQuestions) * 100;
            progressFill.style.width = `${progress}%`;
        }
        
        function startTimer() {
            // Clear any existing timer
            if (gameState.timerInterval) {
                clearInterval(gameState.timerInterval);
            }
            
            // Reset timer bar
            timerBar.style.width = '100%';
            timerBar.style.transition = `width ${gameState.timerDuration}s linear`;
            
            // Start countdown
            setTimeout(() => {
                timerBar.style.width = '0%';
            }, 50);
            
            // Set timeout to auto-advance if time runs out
            gameState.timerInterval = setTimeout(() => {
                if (!gameState.questionAnswered) {
                    // Auto-select correct answer
                    const correctOption = document.querySelector('.option[data-correct="true"]');
                    if (correctOption) {
                        correctOption.click();
                    }
                }
            }, gameState.timerDuration * 1000);
        }
        
        function updateLevelBadges() {
            // Update level badges on welcome screen
            document.querySelectorAll('.level-badge').forEach((badge, index) => {
                const level = badge.getAttribute('data-level');
                
                if (gameState.completedLevels.includes(level)) {
                    badge.classList.add('completed');
                    badge.classList.remove('locked', 'active');
                    
                    // Update connector if not last
                    if (index < gameState.levels.length - 1) {
                        const connector = badge.nextElementSibling;
                        connector.classList.add('active');
                    }
                } else if (level === gameState.currentLevel) {
                    badge.classList.add('active');
                    badge.classList.remove('locked', 'completed');
                } else if (index > gameState.currentLevelIndex) {
                    badge.classList.add('locked');
                    badge.classList.remove('active', 'completed');
                }
            });
        }
        
        function showResults() {
            // Calculate time taken
            const timeTaken = Math.round((gameState.endTime - gameState.startTime) / 1000);
            
            // Update results
            finalScoreEl.textContent = gameState.points;
            timeTakenEl.textContent = timeTaken;
            
            // Show results screen
            resultsScreen.classList.remove('hidden');
            resultsScreen.classList.add('fade-in');
            
            // Create confetti
            createConfetti();
        }
        
        function resetGame() {
            // Hide results screen
            resultsScreen.classList.remove('fade-in');
            resultsScreen.classList.add('hidden');
            
            // Reset level badges
            document.querySelectorAll('.level-badge').forEach((badge, index) => {
                if (index === 0) {
                    badge.classList.add('active');
                    badge.classList.remove('locked', 'completed');
                } else {
                    badge.classList.add('locked');
                    badge.classList.remove('active', 'completed');
                }
            });
            
            // Reset connectors
            document.querySelectorAll('.level-connector').forEach(connector => {
                connector.classList.remove('active');
            });
            
            // Show welcome screen
            welcomeScreen.classList.remove('hidden');
            welcomeScreen.classList.add('fade-in');
        }
        
        function createStarburst(x, y) {
            const starburst = document.createElement('div');
            starburst.className = 'starburst';
            starburst.style.left = `${x}px`;
            starburst.style.top = `${y}px`;
            document.body.appendChild(starburst);
            
            setTimeout(() => {
                document.body.removeChild(starburst);
            }, 500);
        }
        
        function createConfetti() {
            const colors = ['#fbbf24', '#4ade80', '#60a5fa', '#f472b6', '#c084fc'];
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.animation = `fall ${1 + Math.random() * 2}s ease-out forwards`;
                confetti.style.animationDelay = `${Math.random() * 0.5}s`;
                document.body.appendChild(confetti);
                
                setTimeout(() => {
                    document.body.removeChild(confetti);
                }, 3000);
            }
        }
    });
</script>
